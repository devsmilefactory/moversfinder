import { useState, useCallback, useMemo } from 'react';\n\n/**\n * useStepNavigation Hook\n * \n * Provides navigation logic for multi-step forms including:\n * - Step state management\n * - Navigation controls\n * - Progress tracking\n * - Step validation integration\n */\nconst useStepNavigation = ({\n  totalSteps = 5,\n  initialStep = 1,\n  onStepChange,\n  validateStep\n}) => {\n  const [currentStep, setCurrentStep] = useState(initialStep);\n  const [visitedSteps, setVisitedSteps] = useState(new Set([initialStep]));\n  const [completedSteps, setCompletedSteps] = useState(new Set());\n\n  // Calculate progress percentage\n  const progressPercentage = useMemo(() => {\n    return Math.round((currentStep / totalSteps) * 100);\n  }, [currentStep, totalSteps]);\n\n  // Check if we can go to next step\n  const canGoNext = useMemo(() => {\n    return currentStep < totalSteps;\n  }, [currentStep, totalSteps]);\n\n  // Check if we can go to previous step\n  const canGoBack = useMemo(() => {\n    return currentStep > 1;\n  }, [currentStep]);\n\n  // Check if current step is the last step\n  const isLastStep = useMemo(() => {\n    return currentStep === totalSteps;\n  }, [currentStep, totalSteps]);\n\n  // Check if current step is the first step\n  const isFirstStep = useMemo(() => {\n    return currentStep === 1;\n  }, [currentStep]);\n\n  // Go to next step\n  const goToNext = useCallback(async (validationRules) => {\n    if (!canGoNext) return false;\n\n    // Validate current step if validation function is provided\n    if (validateStep) {\n      const isValid = await validateStep(currentStep, validationRules);\n      if (!isValid) return false;\n    }\n\n    const nextStep = currentStep + 1;\n    setCurrentStep(nextStep);\n    setVisitedSteps(prev => new Set([...prev, nextStep]));\n    setCompletedSteps(prev => new Set([...prev, currentStep]));\n    \n    onStepChange?.(nextStep, currentStep);\n    return true;\n  }, [currentStep, canGoNext, validateStep, onStepChange]);\n\n  // Go to previous step\n  const goToPrevious = useCallback(() => {\n    if (!canGoBack) return false;\n\n    const prevStep = currentStep - 1;\n    setCurrentStep(prevStep);\n    \n    onStepChange?.(prevStep, currentStep);\n    return true;\n  }, [currentStep, canGoBack, onStepChange]);\n\n  // Go to specific step\n  const goToStep = useCallback(async (step, validationRules, allowSkip = false) => {\n    if (step < 1 || step > totalSteps) return false;\n    if (step === currentStep) return true;\n\n    // If going forward, validate all steps in between (unless skipping is allowed)\n    if (step > currentStep && !allowSkip && validateStep) {\n      for (let i = currentStep; i < step; i++) {\n        const isValid = await validateStep(i, validationRules);\n        if (!isValid) return false;\n        setCompletedSteps(prev => new Set([...prev, i]));\n      }\n    }\n\n    setCurrentStep(step);\n    setVisitedSteps(prev => new Set([...prev, step]));\n    \n    onStepChange?.(step, currentStep);\n    return true;\n  }, [currentStep, totalSteps, validateStep, onStepChange]);\n\n  // Mark step as completed\n  const markStepCompleted = useCallback((step) => {\n    setCompletedSteps(prev => new Set([...prev, step]));\n  }, []);\n\n  // Mark step as incomplete\n  const markStepIncomplete = useCallback((step) => {\n    setCompletedSteps(prev => {\n      const newSet = new Set(prev);\n      newSet.delete(step);\n      return newSet;\n    });\n  }, []);\n\n  // Check if step is completed\n  const isStepCompleted = useCallback((step) => {\n    return completedSteps.has(step);\n  }, [completedSteps]);\n\n  // Check if step has been visited\n  const isStepVisited = useCallback((step) => {\n    return visitedSteps.has(step);\n  }, [visitedSteps]);\n\n  // Check if step is accessible (visited or adjacent to current)\n  const isStepAccessible = useCallback((step) => {\n    return visitedSteps.has(step) || Math.abs(step - currentStep) <= 1;\n  }, [visitedSteps, currentStep]);\n\n  // Get step status\n  const getStepStatus = useCallback((step) => {\n    if (step === currentStep) return 'current';\n    if (completedSteps.has(step)) return 'completed';\n    if (visitedSteps.has(step)) return 'visited';\n    if (step < currentStep) return 'skipped';\n    return 'upcoming';\n  }, [currentStep, completedSteps, visitedSteps]);\n\n  // Reset navigation state\n  const reset = useCallback((newInitialStep = 1) => {\n    setCurrentStep(newInitialStep);\n    setVisitedSteps(new Set([newInitialStep]));\n    setCompletedSteps(new Set());\n  }, []);\n\n  // Get navigation summary\n  const getNavigationSummary = useCallback(() => {\n    return {\n      currentStep,\n      totalSteps,\n      progressPercentage,\n      completedSteps: Array.from(completedSteps),\n      visitedSteps: Array.from(visitedSteps),\n      canGoNext,\n      canGoBack,\n      isFirstStep,\n      isLastStep\n    };\n  }, [\n    currentStep,\n    totalSteps,\n    progressPercentage,\n    completedSteps,\n    visitedSteps,\n    canGoNext,\n    canGoBack,\n    isFirstStep,\n    isLastStep\n  ]);\n\n  // Generate step indicators data\n  const getStepIndicators = useCallback(() => {\n    return Array.from({ length: totalSteps }, (_, index) => {\n      const step = index + 1;\n      return {\n        step,\n        status: getStepStatus(step),\n        accessible: isStepAccessible(step),\n        completed: isStepCompleted(step),\n        visited: isStepVisited(step),\n        current: step === currentStep\n      };\n    });\n  }, [totalSteps, getStepStatus, isStepAccessible, isStepCompleted, isStepVisited, currentStep]);\n\n  return {\n    // State\n    currentStep,\n    totalSteps,\n    progressPercentage,\n    visitedSteps,\n    completedSteps,\n    \n    // Status checks\n    canGoNext,\n    canGoBack,\n    isFirstStep,\n    isLastStep,\n    \n    // Navigation actions\n    goToNext,\n    goToPrevious,\n    goToStep,\n    \n    // Step management\n    markStepCompleted,\n    markStepIncomplete,\n    isStepCompleted,\n    isStepVisited,\n    isStepAccessible,\n    getStepStatus,\n    \n    // Utilities\n    reset,\n    getNavigationSummary,\n    getStepIndicators\n  };\n};\n\nexport default useStepNavigation;"